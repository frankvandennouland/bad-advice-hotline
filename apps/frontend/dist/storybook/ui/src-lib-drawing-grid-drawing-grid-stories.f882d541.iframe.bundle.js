"use strict";(self.webpackChunk_algorithm_dashboard_source=self.webpackChunk_algorithm_dashboard_source||[]).push([[781],{"./libs/ui/src/lib/drawing-grid/drawing-grid.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>DrawingGridComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),Subject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subject.js"),takeUntil=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/takeUntil.js"),identity=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/util/identity.js"),lift=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/util/lift.js"),OperatorSubscriber=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/OperatorSubscriber.js");function defaultCompare(a,b){return a===b}var drawing_grid_service=__webpack_require__("./libs/ui/src/lib/drawing-grid/drawing-grid.service.ts"),interfaces=__webpack_require__("./libs/ui/src/lib/drawing-grid/interfaces/index.ts");let DrawingGridComponent=class DrawingGridComponent{constructor(gridService){this.gridService=gridService,this.destroy$=new Subject.B,this.fillStyle="#424242",this.disabled=!1,this.mouseDown=new core.EventEmitter,this.mouseMove=new core.EventEmitter,this.mouseUp=new core.EventEmitter,this.contextMenu=new core.EventEmitter}ngOnInit(){this.gridService.isMouseLocked$.pipe((0,takeUntil.Q)(this.destroy$)).subscribe((isMouseLocked=>this.isMouseLocked=isMouseLocked)),this.gridService.pixels$.pipe(function distinctUntilChanged(comparator,keySelector){return void 0===keySelector&&(keySelector=identity.D),comparator=null!=comparator?comparator:defaultCompare,(0,lift.N)((function(source,subscriber){var previousKey,first=!0;source.subscribe((0,OperatorSubscriber._)(subscriber,(function(value){var currentKey=keySelector(value);!first&&comparator(previousKey,currentKey)||(first=!1,previousKey=currentKey,subscriber.next(value))})))}))}(),(0,takeUntil.Q)(this.destroy$)).subscribe((pixels=>{pixels&&this.renderingContext&&this.render(pixels)})),this.calculateGridSizes(),this.gridService.pixels=this.generatePixels()}ngAfterViewInit(){this.renderingContext=this.canvasRef.nativeElement.getContext("2d"),this.clearCanvas(),this.renderGrid()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onMouseDown(event){if(!this.disabled){const pixel=this.getPixelAt(event.offsetX,event.offsetY);pixel&&this.mouseDown.emit(pixel)}}onMouseMove(event){if(!this.disabled&&this.isMouseLocked){const pixel=this.getPixelAt(event.offsetX,event.offsetY);if(pixel){if(this.cachedPixel&&this.cachedPixel.x===pixel.x&&this.cachedPixel.y===pixel.y)return;this.cachedPixel=pixel,this.mouseMove.emit(pixel)}}}onMouseUp(event){if(!this.disabled&&this.isMouseLocked){this.gridService.setPaintingMode(interfaces.k.CREATE);const pixel=this.getPixelAt(event.offsetX,event.offsetY);pixel&&this.mouseUp.emit(pixel)}}onContextMenu(event){if(event.preventDefault(),!this.disabled){this.gridService.setPaintingMode(interfaces.k.ERASE);const pixel=this.getPixelAt(event.offsetX,event.offsetY);pixel&&this.contextMenu.emit(pixel)}}lockMouse(event){this.disabled||(event.preventDefault(),event.stopPropagation(),this.gridService.lockMouse())}releaseMouse(event){this.disabled||(event.preventDefault(),event.stopPropagation(),this.gridService.releaseMouse())}render(pixels){this.clearCanvas(),[].concat(...pixels).forEach((pixel=>{const{x,y}=pixel;pixel.fillStyle&&this.renderingContext&&(this.renderingContext.fillStyle=pixel.fillStyle,this.renderingContext.fillRect(x*this.pixelSize+this.paddingLeft,y*this.pixelSize+this.paddingTop,this.pixelSize,this.pixelSize))})),this.renderGrid()}renderGrid(){if(this.renderingContext&&this.width&&this.height){this.renderingContext.strokeStyle=this.fillStyle,this.renderingContext.beginPath();for(let x=this.paddingLeft;x<=this.width-this.paddingRight;x+=this.pixelSize)this.renderingContext.moveTo(x,this.paddingTop),this.renderingContext.lineTo(x,this.height-this.paddingBottom);for(let y=this.paddingTop;y<=this.height-this.paddingBottom;y+=this.pixelSize)this.renderingContext.moveTo(this.paddingLeft,y),this.renderingContext.lineTo(this.width-this.paddingRight,y);this.renderingContext.stroke()}}clearCanvas(){this.renderingContext&&this.width&&this.height&&this.renderingContext.clearRect(0,0,this.width,this.height)}calculateGridSizes(){this.width&&this.height&&(this.xNodes||(this.xNodes=Math.floor(this.width/this.pixelSize)),this.yNodes||(this.yNodes=Math.floor(this.height/this.pixelSize)),this.paddingX=this.width-this.xNodes*this.pixelSize,this.paddingY=this.height-this.yNodes*this.pixelSize,this.paddingLeft=Math.ceil(this.paddingX/3)-.5,this.paddingTop=Math.ceil(this.paddingY/3)-.5,this.paddingRight=this.width-this.xNodes*this.pixelSize-this.paddingLeft,this.paddingBottom=this.height-this.yNodes*this.pixelSize-this.paddingTop)}generatePixels(){const pixels=[];let index=0;for(let y=0;y<this.yNodes;y++)for(let x=0;x<this.xNodes;x++)pixels[index]={id:`${y}-${x}`,x,y},index++;return pixels}getPixelAt(x,y){return this.gridService.getPixel(Math.floor(x/this.pixelSize),Math.floor(y/this.pixelSize))}static{this.ctorParameters=()=>[{type:drawing_grid_service.i}]}static{this.propDecorators={width:[{type:core.Input}],height:[{type:core.Input}],xNodes:[{type:core.Input}],yNodes:[{type:core.Input}],pixelSize:[{type:core.Input}],fillStyle:[{type:core.Input}],disabled:[{type:core.Input}],mouseDown:[{type:core.Output}],mouseMove:[{type:core.Output}],mouseUp:[{type:core.Output}],contextMenu:[{type:core.Output}],canvasRef:[{type:core.ViewChild,args:["canvas"]}]}}};DrawingGridComponent=(0,tslib_es6.Cg)([(0,core.Component)({selector:"ui-drawing-grid",standalone:!0,imports:[common.CommonModule,fesm2022_forms.YN,fesm2022_forms.X1],template:'<div\n  *ngIf="width && height"\n  (mousedown)="lockMouse($event)"\n  (mouseup)="releaseMouse($event)"\n>\n  <canvas\n    #canvas\n    class="pixels"\n    [width]="width"\n    [height]="height"\n    (mousedown)="onMouseDown($event)"\n    (mousemove)="onMouseMove($event)"\n    (mouseup)="onMouseUp($event)"\n    (contextmenu)="onContextMenu($event)"\n  >\n  </canvas>\n</div>\n',changeDetection:core.ChangeDetectionStrategy.OnPush,schemas:[core.CUSTOM_ELEMENTS_SCHEMA]}),(0,tslib_es6.Sn)("design:paramtypes",[drawing_grid_service.i])],DrawingGridComponent)},"./libs/ui/src/lib/drawing-grid/drawing-grid.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{i:()=>DrawingGridService});var tslib__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js"),_interfaces__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./libs/ui/src/lib/drawing-grid/interfaces/index.ts");let DrawingGridService=class DrawingGridService{constructor(){this._isMouseLocked=new rxjs__WEBPACK_IMPORTED_MODULE_1__.t(!1),this._paintingMode=new rxjs__WEBPACK_IMPORTED_MODULE_1__.t(_interfaces__WEBPACK_IMPORTED_MODULE_0__.k.CREATE),this._pixels=new rxjs__WEBPACK_IMPORTED_MODULE_1__.t([]),this.isMouseLocked$=this._isMouseLocked.asObservable(),this.paintingMode$=this._paintingMode.asObservable(),this.pixels$=this._pixels.asObservable()}lockMouse(){this.isMouseLocked=!0}releaseMouse(){this.isMouseLocked=!1}setPaintingMode(mode){this._paintingMode.next(mode)}fillPixel(x,y,color){this.updatePixel(x,y,color.value)}clearPixel(x,y){this.updatePixel(x,y,void 0)}getPixel(x,y){return this.pixels.find((pixel=>pixel.x===x&&pixel.y===y))}getPixelById(id){return this.pixels.find((pixel=>pixel.id===id))}updatePixel(x,y,fillStyle){const pixel=this.getPixelById(`${y}-${x}`);if(pixel){if(pixel.fillStyle===fillStyle)return;const index=this.pixels.indexOf(pixel);this.pixels[index]={...pixel,fillStyle},this.pixels=[...this.pixels]}}get isMouseLocked(){return this._isMouseLocked.getValue()}set isMouseLocked(isMouseLocked){this._isMouseLocked.next(isMouseLocked)}get pixels(){return this._pixels.getValue()}set pixels(pixels){this._pixels.next(pixels)}};DrawingGridService=(0,tslib__WEBPACK_IMPORTED_MODULE_2__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.Injectable)({providedIn:"root"})],DrawingGridService)},"./libs/ui/src/lib/drawing-grid/drawing-grid.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var _angular_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),_angular_forms__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),_storybook_angular__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@storybook/angular/dist/index.mjs"),_drawing_grid_component__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./libs/ui/src/lib/drawing-grid/drawing-grid.component.ts");const __WEBPACK_DEFAULT_EXPORT__={title:"Components/Drawing grid",component:_angular_core__WEBPACK_IMPORTED_MODULE_2__.Component,argTypes:{width:{description:"width of the canvas",control:{type:"number"}},height:{description:"height of the canvas",control:{type:"number"}},xNodes:{description:"number of nodes on the x axes",control:{type:"number"}},yNodes:{description:"number of nodes on the y axes",control:{type:"number"}},pixelSize:{description:"size of the pixel within the canvas",control:{type:"number"}},fillStyle:{description:"pixel fill style",control:{type:"text"}},disabled:{description:"speaks for its self",control:{type:"boolean"}}},decorators:[(0,_storybook_angular__WEBPACK_IMPORTED_MODULE_0__.moduleMetadata)({imports:[_angular_forms__WEBPACK_IMPORTED_MODULE_3__.YN,_angular_forms__WEBPACK_IMPORTED_MODULE_3__.X1,_drawing_grid_component__WEBPACK_IMPORTED_MODULE_1__.c]})],parameters:{docs:{description:{component:"\n### Basic setup\n\n```\n<ui-drawing-grid></ui-drawing-grid>\n```\n"}}}},Default={render:args=>({props:args,template:'\n<ui-drawing-grid \n[width]="width"\n[height]="height"\n[xNodes]="xNodes"\n[yNodes]="yNodes"\n[pixelSize]="pixelSize"\n[fillStyle]="fillStyle"\n[disabled]="disabled"\n>\n</ui-drawing-grid>\n'}),args:{width:1100,height:1100,xNodes:50,yNodes:50,pixelSize:20,fillStyle:"#424242",disabled:!1}},__namedExportsOrder=["Default"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{\n  render: defaultDrawingGrid,\n  args: {\n    width: 1100,\n    height: 1100,\n    xNodes: 50,\n    yNodes: 50,\n    pixelSize: 20,\n    fillStyle: '#424242',\n    disabled: false\n  }\n}",...Default.parameters?.docs?.source}}}},"./libs/ui/src/lib/drawing-grid/interfaces/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var PaintingMode;__webpack_require__.d(__webpack_exports__,{k:()=>PaintingMode}),function(PaintingMode){PaintingMode.CREATE="create",PaintingMode.ERASE="erase"}(PaintingMode||(PaintingMode={}))},"./node_modules/rxjs/dist/esm5/internal/operators/takeUntil.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Q:()=>takeUntil});var _util_lift__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/util/lift.js"),_OperatorSubscriber__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/OperatorSubscriber.js"),_observable_innerFrom__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/innerFrom.js"),_util_noop__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/util/noop.js");function takeUntil(notifier){return(0,_util_lift__WEBPACK_IMPORTED_MODULE_0__.N)((function(source,subscriber){(0,_observable_innerFrom__WEBPACK_IMPORTED_MODULE_1__.Tg)(notifier).subscribe((0,_OperatorSubscriber__WEBPACK_IMPORTED_MODULE_2__._)(subscriber,(function(){return subscriber.complete()}),_util_noop__WEBPACK_IMPORTED_MODULE_3__.l)),!subscriber.closed&&source.subscribe(subscriber)}))}}}]);